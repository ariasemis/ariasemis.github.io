<section id="comments">
    <h2>Comments</h2>

    <form method="POST" action="{{ site.staticman_url }}" >
        
        <fieldset>
            <label class="autosize">
                <span>Leave a Comment:</span>
                <textarea
                    name="fields[message]"
                    rows="1"
                    oninput="this.parentNode.dataset.value = this.value"
                    spellcheck></textarea>
            </label>

            <label>
                <span>Name:</span>
                <input type="text" name="fields[name]">
            </label>

            <label>
                <span>E-mail:</span>
                <input type="email" name="fields[email]">
            </label>
        </fieldset>

        <fieldset class="hidden">
            <input type="hidden" name="options[slug]" value="{{ page.slug }}">
            <input type="hidden" name="options[redirect]" value="{{ page.url | absolute_url }}">
            <label>
                <input type="text" name="fields[honey]" autocomplete="off" placeholder="Leave blank if you are a human">
            </label>
        </fieldset>

        <button>Submit</button>
    </form>

    {% if site.data.comments[page.slug] %}
    <div class="comment-list">
        {% assign comments = site.data.comments[page.slug] | sort %}
        {% for comment in comments %}
        <div class="comment-item">
            <img class="comment-avatar" src="https://www.gravatar.com/avatar/{{ comment[1].email }}?d=mm&amp;s=50" alt="{{ comment[1].name }}">
            <div>
                <header class="comment-meta">
                    <strong>{{ comment[1].name }}</strong>
                    on
                    <time datetime="{{ comment[1].date | date_to_xmlschema }}">{{ comment[1].date | date: "%Y-%m-%d" }}</time>
                </header>
                <div>
                    {{ comment[1].message | markdownify }}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

</section>